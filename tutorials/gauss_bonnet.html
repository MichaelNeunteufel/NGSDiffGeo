

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gauss-Bonnet theorem &mdash; NGSDiffGeo 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regge finite elements and Regge metrics" href="regge_metric.html" />
    <link rel="prev" title="Curvature quantities on Riemannian manifolds" href="curvatures.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NGSDiffGeo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="riemannian_manifolds.html">Riemannian Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="covariant_derivatives.html">Covariant Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="curvatures.html">Curvature quantities on Riemannian manifolds</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Gauss-Bonnet theorem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Surfaces-without-a-boundary">Surfaces without a boundary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Gauss-Bonnet-for-non-closed-and-non-smooth-surfaces">Gauss-Bonnet for non-closed and non-smooth surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Gauss-Bonnet-for-surfaces-with-piecewise-smooth-boundary">Gauss-Bonnet for surfaces with piecewise smooth boundary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Gauss-Bonnet-on-more-non-smooth-surfaces">Gauss-Bonnet on more non-smooth surfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="regge_metric.html">Regge finite elements and Regge metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_gauss_curvature.html">Distributional Gauss curvature</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_gauss_curvature_analysis.html">Distributional Gauss curvature (analysis)</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_gauss_curvature_surface.html">Gauss curvature approximation on embedded surfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_scalar_curvature.html">Distributional scalar curvature</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_einstein_tensor.html">Distributional Einstein curvature</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_riemann_curvature_tensor.html">Distributional Riemann curvature tensor curvature</a></li>
<li class="toctree-l1"><a class="reference internal" href="linearization_curvature_quantitites.html">Linearization of curvature quantities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NGSDiffGeo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Gauss-Bonnet theorem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/gauss_bonnet.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Gauss-Bonnet-theorem">
<h1>Gauss-Bonnet theorem<a class="headerlink" href="#Gauss-Bonnet-theorem" title="Link to this heading"></a></h1>
<p>This notebook discusses the Gauss-Bonnet theorem for smooth manifolds without boundary, with a smooth boundary, and piecewise smooth boundary with vertices. The arising curvature quantities are the Gauss curvature of the manifold, the geodesic curvature on the smooth part of the boundary, and the angle defect (angle deficit) at the non-smooth vertices of the boundary. The Gauss-Bonnet theorem relates the curvature of a surface <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> with a topological quantity. More precisely, the
Gauss-Bonnet theorem holds for two-dimensional Riemannian manifolds, but we consider two-dimensional surfaces embedded in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> for visualisation.</p>
<section id="Surfaces-without-a-boundary">
<h2>Surfaces without a boundary<a class="headerlink" href="#Surfaces-without-a-boundary" title="Link to this heading"></a></h2>
<p>For closed smooth surfaces <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> without a boundary, i.e. <span class="math notranslate nohighlight">\(\partial\mathcal{S}=\emptyset\)</span>, there holds with the Gauss curvature <span class="math notranslate nohighlight">\(K\)</span> the following version of the Gauss-Bonnet theorem: <span class="math">\begin{align*}
\int_{\mathcal{S}}K\,ds = 2\pi\chi_{\mathcal{S}}.
\end{align*}</span> Here <span class="math notranslate nohighlight">\(\chi_{\mathcal{S}}\)</span> is the Euler characteristic of the surface, a topological quantity. For a triangulation of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> the Euler characteristic can be computed with the formula <span class="math notranslate nohighlight">\(\chi_{\mathcal{S}}=\# T-\# E + \# V\)</span>, i.e., the number of triangles minus number of edges plus number of vertices. It is related to the genus <span class="math notranslate nohighlight">\(g\)</span> of a connected closed surface (‘’number of holes’’). For orientable surfaces there holds <span class="math notranslate nohighlight">\(\chi_{\mathcal{S}}=2-2g\)</span>.</p>
<p>We investigate some closed surfaces.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ngsolve</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">netgen.occ</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ngsolve.webgui</span><span class="w"> </span><span class="kn">import</span> <span class="n">Draw</span>

<span class="c1"># polynomial order for curving the surface</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">4</span>


<span class="c1"># utility function to compute the Gauss curvature on a surface</span>
<span class="k">def</span><span class="w"> </span><span class="nf">GaussCurvature</span><span class="p">():</span>
    <span class="n">nsurf</span> <span class="o">=</span> <span class="n">specialcf</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Cof</span><span class="p">(</span><span class="n">Grad</span><span class="p">(</span><span class="n">nsurf</span><span class="p">))</span> <span class="o">*</span> <span class="n">nsurf</span> <span class="o">*</span> <span class="n">nsurf</span>
</pre></div>
</div>
</div>
<p>For a sphere of radius <span class="math notranslate nohighlight">\(R&gt;0\)</span> the Gauss curvature is <span class="math notranslate nohighlight">\(K=\frac{1}{R^2}\)</span> and its Euler characteristic <span class="math notranslate nohighlight">\(2\)</span> (genus <span class="math notranslate nohighlight">\(g=0\)</span>, no holes). We observe that the integral does not perfectly fit with the expected value. However, it gets way more accurate if we approximate the surface by a higher polynomial degree (or generate a finer mesh). We will understand why this happens later in this notebook.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sphere</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">sphere</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 4*pi = </span><span class="si">{</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K = 12.566702932823457 = 4*pi = 12.566370614359172 = 2*pi*(#T-#E+#V) = 12.566370614359172
</pre></div></div>
</div>
<p>An ellipsoid is topologically equivalent to a sphere. Therefore, we expect it to have the same Euler characteristic.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ell</span> <span class="o">=</span> <span class="n">Ellipsoid</span><span class="p">(</span><span class="n">Axes</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.07</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 4*pi = </span><span class="si">{</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K = 12.572887860639069 = 4*pi = 12.566370614359172 = 2*pi*(#T-#E+#V) = 12.566370614359172
</pre></div></div>
</div>
<p>A torus has Euler characteristic <span class="math notranslate nohighlight">\(\chi_{\mathcal{S}}=0\)</span>. Its genus is <span class="math notranslate nohighlight">\(g=1\)</span> as it has one hole.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circ</span> <span class="o">=</span> <span class="n">WorkPlane</span><span class="p">(</span><span class="n">Axes</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Face</span><span class="p">()</span>
<span class="n">torus</span> <span class="o">=</span> <span class="n">Revolve</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">Axis</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="mi">360</span><span class="p">)</span>
<span class="n">torus</span><span class="o">.</span><span class="n">faces</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;torus&quot;</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">torus</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 0&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K = 0.017253064926507904 = 0 = 2*pi*(#T-#E+#V) = 0.0
</pre></div></div>
</div>
</section>
<section id="Gauss-Bonnet-for-non-closed-and-non-smooth-surfaces">
<h2>Gauss-Bonnet for non-closed and non-smooth surfaces<a class="headerlink" href="#Gauss-Bonnet-for-non-closed-and-non-smooth-surfaces" title="Link to this heading"></a></h2>
<p>Let’s try combining two tori such that the Euler characteristic changes to <span class="math notranslate nohighlight">\(-2\)</span> because now two holes are present.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torus2</span> <span class="o">=</span> <span class="n">Translation</span><span class="p">((</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span><span class="n">torus</span><span class="p">)</span>
<span class="n">torus2</span><span class="o">.</span><span class="n">faces</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;torus2&quot;</span>
<span class="n">two_torus</span> <span class="o">=</span> <span class="n">Glue</span><span class="p">((</span><span class="n">torus2</span> <span class="o">-</span> <span class="n">torus</span><span class="p">)</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="s2">&quot;torus2&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">torus</span> <span class="o">-</span> <span class="n">torus2</span><span class="p">)</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="s2">&quot;torus&quot;</span><span class="p">])</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">two_torus</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 2 * pi * (2 - 4)&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2"> = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K = -4.099770502767808 = 2 * pi * (2 - 4) = -12.566370614359172 = 2*pi*(#T-#E+#V) = -12.566370614359172
</pre></div></div>
</div>
<p>The computation by counting the number of triangles, edges, and vertices matches the expected value. However, the integral of the Gauss curvature does not. Why?</p>
<p>The generated surface is not smooth at the interface!</p>
<p>For non-closed and non-smooth surfaces, the Gauss-Bonnet theorem takes a different form: <span class="math">\begin{align*}
\int_{\mathcal{S}}K\,ds + \int_{\partial \mathcal{S}}\kappa_g\,dl = 2\pi\chi_{\mathcal{S}},
\end{align*}</span> where <span class="math notranslate nohighlight">\(\kappa_g\)</span> denotes the geodesic curvature of the boundary curve <span class="math notranslate nohighlight">\(\partial \mathcal{S}\)</span> We must include the geodesic curvature at the non-smooth interface from both sides of the tori to obtain the correct results. We recall that with the tangent vector <span class="math notranslate nohighlight">\(t\)</span> and co-normal vector <span class="math notranslate nohighlight">\(\mu\)</span> the geodesic curvature is given by <span class="math">\begin{align*}
\kappa_g = \nabla_tt\cdot \mu.
\end{align*}</span> Note that for a smooth surface, at least <span class="math notranslate nohighlight">\(C^1\)</span>, the geodesic curvature computed along a curve inside the manifold coincides when computed from both sides up to a sign (the co-normal vector changes its orientation). Then, the sum of the geodesic curvatures cancels out.</p>
<p>Let’s try the previous example, but now including the geodesic curvature. Now, the result looks good again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">Cross</span><span class="p">(</span><span class="n">specialcf</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">specialcf</span><span class="o">.</span><span class="n">tangential</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="c1"># for geodesic curvature</span>
<span class="n">edge_curve</span> <span class="o">=</span> <span class="n">specialcf</span><span class="o">.</span><span class="n">EdgeCurvature</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># nabla_t t</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K + int_</span><span class="se">{{</span><span class="s2">dS</span><span class="se">}}</span><span class="s2"> k_g = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; + </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="o">-</span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K + int_{dS} k_g = -4.099770502767808 + -8.477226902598067 = -12.576997405365876
</pre></div></div>
</div>
</section>
<section id="Gauss-Bonnet-for-surfaces-with-piecewise-smooth-boundary">
<h2>Gauss-Bonnet for surfaces with piecewise smooth boundary<a class="headerlink" href="#Gauss-Bonnet-for-surfaces-with-piecewise-smooth-boundary" title="Link to this heading"></a></h2>
<p>Consider a flat rectangle. It is topologically equivalent to the half-sphere. Thus <span class="math notranslate nohighlight">\(\chi_{\mathcal{S}}=1\)</span>. However, it has zero Gauss and geodesic curvature. To account for the non-smooth boundary of the rectangle, we extend the Gauss-Bonnet theorem to its general form <span class="math">\begin{align*}
\int_{\mathcal{S}}K\,ds + \int_{\partial \mathcal{S}}\kappa_g\,dl + \sum_{\mathrm{vertices}\,V}(\pi-\varepsilon_V)= 2\pi\chi_{\mathcal{S}}.
\end{align*}</span> Here, we sum over all vertices, where the boundary is non-smooth and compute the jump angle <span class="math notranslate nohighlight">\(\varepsilon_V\)</span>, which measures the angle from the incoming tangent vector to the outgoing tangent vector. The interior angle used in the Gauss-Bonnet theorem is given by <span class="math notranslate nohighlight">\(\pi-\varepsilon_V\)</span>. For a smooth triangulation of a smooth manifold, the sum of the jump angles at a vertex <span class="math notranslate nohighlight">\(V\)</span> will add up to <span class="math notranslate nohighlight">\(2\pi\)</span>. However, for a non-smooth surface, like we are considering, the
sum won’t be <span class="math notranslate nohighlight">\(2\pi\)</span>. Thus, we can define the so-called angle defect <span class="math notranslate nohighlight">\(\sphericalangle_V\)</span> as <span class="math">\begin{align*}
\sphericalangle_V = 2\pi-\sum_{T\supset V}\sphericalangle_V^T,\qquad \sphericalangle_V^T= \arccos(t_1,t_2),
\end{align*}</span> where <span class="math notranslate nohighlight">\(t_1\)</span> and <span class="math notranslate nohighlight">\(t_2\)</span> are the two unit tangent vectors starting at <span class="math notranslate nohighlight">\(V\)</span> and going in direction of the edges attached to <span class="math notranslate nohighlight">\(V\)</span> on the element <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>In summary, we need to consider the Gauss curvature, geodesic curvature, and the interior angle for the Gauss-Bonnet theorem, visualized in the following picture. Thus, all these quantities are tightly connected to each other.</p>
<center><p><img alt="14b3f1cdc1294dd3b7233e2e1ce41307" class="no-scaled-link" src="../_images/curved_triangle_gb.png" style="width: 150px;" /></p>
</center><p>For the rectangle, each of its four vertices has an angle of <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span> and thus some up to <span class="math notranslate nohighlight">\(2\pi\)</span> such that Gauss-Bonnet is again fulfilled.</p>
<center><p><img alt="6dfe3bdad75342d59bab5e6b1f568636" class="no-scaled-link" src="../_images/rect_gb.png" style="width: 180px;" /></p>
</center><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># auxiliary function to compute the angle deficit of the interior vertices</span>
<span class="c1"># and the interior angle for boundary vertices of a surface</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ComputeAngleDeficit</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">correct_bnd_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">bbnd_tang</span> <span class="o">=</span> <span class="n">specialcf</span><span class="o">.</span><span class="n">VertexTangentialVectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">bbnd_tang1</span> <span class="o">=</span> <span class="n">bbnd_tang</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">bbnd_tang2</span> <span class="o">=</span> <span class="n">bbnd_tang</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="n">fesH</span> <span class="o">=</span> <span class="n">H1</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">fesH</span><span class="o">.</span><span class="n">TnT</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">LinearForm</span><span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">acos</span><span class="p">(</span><span class="n">bbnd_tang1</span> <span class="o">*</span> <span class="n">bbnd_tang2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ds</span><span class="p">(</span><span class="n">element_vb</span><span class="o">=</span><span class="n">BBND</span><span class="p">))</span><span class="o">.</span><span class="n">Assemble</span><span class="p">()</span>

    <span class="n">gf_angle_def</span> <span class="o">=</span> <span class="n">GridFunction</span><span class="p">(</span><span class="n">fesH</span><span class="p">)</span>
    <span class="c1"># angle deficit at interior vertices</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)):</span>
        <span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># corrrect angle for boundary vertices</span>
    <span class="k">if</span> <span class="n">correct_bnd_vertices</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">fesH</span><span class="o">.</span><span class="n">Elements</span><span class="p">(</span><span class="n">BBND</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">el</span><span class="o">.</span><span class="n">dofs</span><span class="p">:</span>
                <span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">draw</span><span class="p">:</span>
        <span class="n">Draw</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="s2">&quot;angle_deficit&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gf_angle_def</span>


<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Face</span><span class="p">(),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">gf_angle_def</span> <span class="o">=</span> <span class="n">ComputeAngleDeficit</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">correct_bnd_vertices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K + int_</span><span class="se">{{</span><span class="s2">dS</span><span class="se">}}</span><span class="s2"> k_g = &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; =  2*pi = </span><span class="si">{</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="si">}</span><span class="s2"> = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K + int_{dS} k_g = 6.283185307179734 =  2*pi = 6.283185307179586 = 2*pi*(#T-#E+#V) = 6.283185307179586
</pre></div></div>
</div>
<p>If we round the edges such that a C1-boundary is obtained, the geodesic curvature <span class="math notranslate nohighlight">\(\kappa_g\)</span> includes all curvature information. Thus, the vertex contributions can be seen as the limit of geodesic curvatures (magnitude <span class="math notranslate nohighlight">\(\frac{1}{\varepsilon}\)</span>) integrated over the circle part (magnitude <span class="math notranslate nohighlight">\(\varepsilon\)</span>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wp</span> <span class="o">=</span> <span class="n">WorkPlane</span><span class="p">()</span>
<span class="n">wp</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="mf">1.6</span><span class="p">)</span><span class="o">.</span><span class="n">Arc</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span><span class="o">.</span><span class="n">Arc</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="mf">1.6</span><span class="p">)</span><span class="o">.</span><span class="n">Arc</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">wp</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span><span class="o">.</span><span class="n">Arc</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">face</span> <span class="o">=</span> <span class="n">wp</span><span class="o">.</span><span class="n">Face</span><span class="p">()</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K + int_</span><span class="se">{{</span><span class="s2">dS</span><span class="se">}}</span><span class="s2"> k_g = &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = 2*pi*(#T-#E+#V) = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K + int_{dS} k_g = 6.289394080128498 = 6.283185307179586 = 2*pi*(#T-#E+#V) = 6.283185307179586
</pre></div></div>
</div>
</section>
<section id="Gauss-Bonnet-on-more-non-smooth-surfaces">
<h2>Gauss-Bonnet on more non-smooth surfaces<a class="headerlink" href="#Gauss-Bonnet-on-more-non-smooth-surfaces" title="Link to this heading"></a></h2>
<p>We apply the Gauss-Bonnet theorem to different non-smooth surfaces.</p>
<p>First, we have a cylinder surface consisting of three smooth surfaces glued together at two boundaries. The cylinder mantle has Gauss curvature zero and also the top and bottom flat circles. Thus, the different geodesic curvatures, when measured from the cylinder mantle, where the geodesic curvature is zero, and the circles, where it is the reciprocal of the circle radius, sum up to <span class="math notranslate nohighlight">\(4\pi\)</span>. It is topologically equivalent to a sphere.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cyl_vol</span> <span class="o">=</span> <span class="n">Cylinder</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cyl</span> <span class="o">=</span> <span class="n">Glue</span><span class="p">([</span><span class="n">cyl_vol</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cyl_vol</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cyl_vol</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K  = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">int_</span><span class="se">{{</span><span class="s2">dS</span><span class="se">}}</span><span class="s2"> k_g&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="o">-</span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">2*pi*(#T-#E+#V)&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K  = 0.0014061761979716643
int_{dS} k_g = 12.573826270855013
2*pi*(#T-#E+#V) = 12.566370614359172
</pre></div></div>
</div>
<p>By smoothing the boundaries to be <span class="math notranslate nohighlight">\(C^1\)</span>, the Gauss curvature contains all curvature information. Thus, the geodesic curvature can be understood as the limit of the Gauss curvature when the surface degenerates to a curve.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cyl_curved</span> <span class="o">=</span> <span class="n">cyl_vol</span><span class="o">.</span><span class="n">MakeFillet</span><span class="p">(</span><span class="n">cyl</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">faces</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">cyl_curved</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">(),</span> <span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;int_S K = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">int_</span><span class="se">{{</span><span class="s2">dS</span><span class="se">}}</span><span class="s2"> k_g&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="o">-</span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">2*pi*(#T-#E+#V)&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; = </span><span class="si">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">nface</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nedge</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mesh</span><span class="o">.</span><span class="n">nv</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
int_S K = 12.597224467820945
int_{dS} k_g = -0.0305680670786335
2*pi*(#T-#E+#V) = 12.566370614359172
</pre></div></div>
</div>
<p>Next, we consider the surface of a box. Here, the Gauss curvature and geodesic curvature are zero. All curvature information sits in the eight corners of the box.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube</span> <span class="o">=</span> <span class="n">Box</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>


<span class="n">gf_angle_def</span> <span class="o">=</span> <span class="n">ComputeAngleDeficit</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;K    = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kg   = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="o">-</span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kV   = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;K + kg + kV = &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4*pi        = </span><span class="si">{</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
K    = 0.0
kg   = 9.131304725410944e-13
kV   = 12.566370614359117
K + kg + kV = 12.56637061436003
4*pi        = 12.566370614359172
</pre></div></div>
</div>
<p>We can smooth the vertices to obtain a smooth surface. Then, again, the Gauss curvature contains all curvature information. Thus, the angle defect can also be seen as a limit from the Gauss curvature.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># try out using bonus_order = 0 and bonus_order = 10</span>
<span class="n">bonus_order</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">cube_curved</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">MakeFillet</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">OCCGeometry</span><span class="p">(</span><span class="n">Glue</span><span class="p">(</span><span class="n">cube_curved</span><span class="o">.</span><span class="n">faces</span><span class="p">))</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<span class="n">Draw</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;K    = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">bonus_intorder</span><span class="o">=</span><span class="n">bonus_order</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;kg   = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="o">-</span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="w"> </span><span class="n">bonus_intorder</span><span class="o">=</span><span class="n">bonus_order</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">gf_angle_def</span> <span class="o">=</span> <span class="n">ComputeAngleDeficit</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;kV   = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;K + kg + kV = </span><span class="si">{</span><span class="n">Integrate</span><span class="p">(</span><span class="n">GaussCurvature</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">bonus_intorder</span><span class="o">=</span><span class="n">bonus_order</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">edge_curve</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ds</span><span class="p">(</span><span class="n">element_boundary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="w"> </span><span class="n">bonus_intorder</span><span class="o">=</span><span class="n">bonus_order</span><span class="p">),</span><span class="w"> </span><span class="n">mesh</span><span class="p">,)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">gf_angle_def</span><span class="o">.</span><span class="n">vec</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4*pi        = </span><span class="si">{</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
K    = 12.750119514496292
kg   = -0.18235138482711769
kV   = -7.881543728238682e-05
K + kg + kV = 12.567689314231892
4*pi        = 12.566370614359172
</pre></div></div>
</div>
<p>Observation: As the mesh’s curving is not exact, the angle deficit and jump of geodesic curvature are small but not zero, and the Gauss curvature “misses” some curvature. The geodesic curvature and angle deficit repair this. For piecewise flat triangles, the Gauss and geodesic curvature are zero, so only the angle deficit has an impact.</p>
<p>Note: Use ‘’bonus_intorder’’ in the above cell for exact geodesic and Gauss curvature integration to get the exact values up to machine rounding-error precision.</p>
<p>Remark: There exists no Gauss-Bonnet theorem in three dimensions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="curvatures.html" class="btn btn-neutral float-left" title="Curvature quantities on Riemannian manifolds" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="regge_metric.html" class="btn btn-neutral float-right" title="Regge finite elements and Regge metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Michael Neunteufel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>